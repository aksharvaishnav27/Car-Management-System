<%@ page language="java" contentType="text/html;charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="java.sql.*" %>
<%@ page import="java.io.*" %>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="userdetail.css">
    <title>CARDX - User Detail</title>
</head>

<body>

<% String name=(String) session.getAttribute("first_name")+" "+(String) session.getAttribute("last_name");
 //String lname=(String) session.getAttribute("last_name");
 String pin_code=(String) session.getAttribute("pin_code");
 String area1=(String) session.getAttribute("city");
 String pincode1=(String) session.getAttribute("pin_code");
 String mobile1=(String) session.getAttribute("mobile");
 String area=(String) session.getAttribute("apt_name")+", "+ (String) session.getAttribute("area_name")+", "+(String) session.getAttribute("city")+", "+(String) session.getAttribute("state");
//String name=(String) session.getAttribute("name");%>


    <header>
        <h1>CARDX - User Detail</h1>
    </header>

    <div class="user-card">
        <div class="user-photo">
            <img src="https://source.unsplash.com/random/250x250?person" alt="User Photo">
            <div ><a href="editprofile.jsp"><button class="edit-button">Edit-Profile</button></a></div>
        </div>
        <div class="user-details">
            <table>
                <tr>
                    <td>Name:</td>
                    <td><%=name %></td>
                </tr>
                <tr>
                    <td>Address:</td>
                    <td><%=area %></td>
                </tr>
                <tr>
                    <td>City:</td>
                    <td><%=area1 %> </td>
                </tr>
               
                <tr>
                    <td>Pincode:</td>
                    <td><%=pincode1 %></td>
                </tr>
                <tr>
                    <td>Phone Number:</td>
                    <td><%=mobile1 %></td>
                </tr>
                <tr>
                    <td>Cars Bought:</td>
                    <td>10</td>
                </tr>
                <tr>
                    <td>Cars Sold:</td>
                    <td>5</td>
                </tr>
                <tr>
                    <td>Cars Rented:</td>
                    <td>3</td>
                </tr>
            </table>
        </div>
    </div>

    <!-- Add additional user details as needed -->
    <!-- Bargain Requests section -->
<section class="bargain-requests">
    <!-- Example bargain request 1 -->
      <% try {
    	    HttpSession session=request.getSession();
      
            int a=100;
            Class.forName("org.postgresql.Driver");
            Connection connection = DriverManager.getConnection("jdbc:postgresql://localhost:5432/postgres", "postgres", "jay");
            PreparedStatement preparedStatement = connection.prepareStatement("SELECT * FROM bargain_request" +
                    " WHERE  customer_id=?)");
                    preparedStatemen.setString(1, session.getAttribute("email")) ;  
            ResultSet resultSet = preparedStatement.executeQuery();
            
            ResultSet  name=(ResultSet) session.getAttribute("resultset");
            if(name!=null){
            	resultSet=name;
            	session.removeAttribute("resultset");
            }

            while (resultSet.next()) {
                a++;
        %>
    <div class="bargain-reqtitle"><h1>Sent -Bargain Requests</h1></div>
    <div class="request">
        <div class="user-details">
            <img src="https://source.unsplash.com/random/150x150?person" alt="User Avatar" class="user-avatar">
            <div class="user-info">
                <h2>Robert</h2>
                <p>Price:<%=resultSet.getString("price") %></p>
                <p>Request_time: <%=resultSet.getString("request_time") %></p>
            </div>
        </div>
        <div class="reqstatus">
           <h1>Aceepted</h1>
        </div>
    </div>
    <div class="bargain-reqtitle"><h1>Recived - Bargain Requests</h1></div>
    <!-- Example bargain request 2 -->
    <div class="request">
        <div class="user-details">
            <img src="https://source.unsplash.com/random/140x140?person" alt="User Avatar" class="user-avatar">
            <div class="user-info">
                <h2>Anthony</h2>
                <p>Occupation: Doctor</p>
                <p>Location: LAHospital</p>
            </div>
        </div>
        <div class="buttons">
            <button class="accept-button">Accept</button>
            <button class="reject-button">Reject</button>
        </div>
    </div>

    <!-- Add more requests as needed -->
</section>


</body>

</html>